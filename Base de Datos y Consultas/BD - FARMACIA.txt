CREATE DATABASE FARMACIA
GO
USE FARMACIA
GO

CREATE TABLE PROVINCIAS (
COD_PROVINCIA INT IDENTITY (1,1) NOT NULL,
PROVINCIA VARCHAR(20) NULL,
CONSTRAINT PK_PROVINCIAS PRIMARY KEY (COD_PROVINCIA)
)

CREATE TABLE LOCALIDADES (
COD_LOCALIDAD INT IDENTITY (1,1) NOT NULL,
LOCALIDAD VARCHAR(20) NULL,
COD_PROVINCIA INT NOT NULL,
CONSTRAINT PK_LOCALIDADES PRIMARY KEY (COD_LOCALIDAD),
CONSTRAINT FK_LOCALIDADES_PROVINCIAS FOREIGN KEY (COD_PROVINCIA) REFERENCES PROVINCIAS (COD_PROVINCIA)
)

CREATE TABLE BARRIOS (
COD_BARRIO INT IDENTITY (1,1) NOT NULL,
BARRIO VARCHAR(20) NULL,
COD_LOCALIDAD INT NOT NULL,
CONSTRAINT PK_BARRIOS PRIMARY KEY (COD_BARRIO),
CONSTRAINT FK_BARRIOS_LOCALIDADES FOREIGN KEY (COD_LOCALIDAD) REFERENCES LOCALIDADES (COD_LOCALIDAD)
)

CREATE TABLE OBRAS_SOCIALES (
COD_OBRA_SOCIAL INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR(20) NULL,
CONSTRAINT PK_OBRAS_SOCIALES PRIMARY KEY (COD_OBRA_SOCIAL),
)

CREATE TABLE PLANES (
COD_PLAN INT NOT NULL,
NOMBRE VARCHAR(20) NULL,
COD_OBRA_SOCIAL INT NOT NULL,
CONSTRAINT PK_PLANES PRIMARY KEY (COD_PLAN),
CONSTRAINT FK_PLANES_OBRAS_SOCIALES FOREIGN KEY (COD_OBRA_SOCIAL) REFERENCES OBRAS_SOCIALES (COD_OBRA_SOCIAL)
)

CREATE TABLE EMPRESAS_LOGISTICA (
COD_EMPRESA_LOG INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR(20) NULL,
COD_BARRIO INT NOT NULL,
NRO_CALLE INT NULL,
CALE VARCHAR(20) NOT NULL,
CONSTRAINT PK_EMPRESAS_LOGISTICA PRIMARY KEY (COD_EMPRESA_LOG),
CONSTRAINT FK_EMPLESAS_LOGISTICA_BARRIOS FOREIGN KEY (COD_BARRIO) REFERENCES BARRIOS (COD_BARRIO)
)

CREATE TABLE SEXOS (
COD_SEXO INT IDENTITY (1,1) NOT NULL,
TIPO VARCHAR(20) NULL,
CONSTRAINT PK_SEXOS PRIMARY KEY (COD_SEXO),
)

CREATE TABLE MEDICOS (
COD_MEDICO INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR(20) NOT NULL,
APELLIDO VARCHAR(20) NOT NULL,
MATRICULA INT,
CONSTRAINT PK_MEDICOS PRIMARY KEY (COD_MEDICO)
)

CREATE TABLE TIPOS_DOCUMENTOS (
COD_TIPO_DOC INT IDENTITY (1,1) NOT NULL,
TIPO VARCHAR(20) NOT NULL,
CONSTRAINT PK_TIPOS_DOCUMENTOS PRIMARY KEY (COD_TIPO_DOC)
)

CREATE TABLE CLIENTES (
COD_CLIENTE INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR(20) NOT NULL,
APELLIDO VARCHAR(20) NOT NULL,
COD_TIPO_DOC INT NOT NULL,
NRO_CALLE INT NOT NULL,
COD_BARRIO INT NOT NULL,
NRO_DOC INT NULL,
CALLE VARCHAR(20) NULL,
NRO_AFILIADO INT NULL,
COD_PLAN INT NOT NULL,
FECHA_NAC SMALLDATETIME NULL,
COD_SEXO INT NOT NULL,
CONSTRAINT PK_CLIENTES PRIMARY KEY (COD_CLIENTE),
CONSTRAINT FK_CLIENTES_TIPOS_DOCUMENTOS FOREIGN KEY (COD_TIPO_DOC) REFERENCES TIPOS_DOCUMENTOS (COD_TIPO_DOC),
CONSTRAINT FK_CLIENTES_BARRIOS FOREIGN KEY (COD_BARRIO) REFERENCES BARRIOS (COD_BARRIO),
CONSTRAINT FK_CLIENTES_PLANES FOREIGN KEY (COD_PLAN) REFERENCES PLANES (COD_PLAN),
CONSTRAINT FK_CLIENTES_TIPOS_SEXOS FOREIGN KEY (COD_SEXO) REFERENCES SEXOS (COD_SEXO)
)

CREATE TABLE TIPOS_CONTACTOS (
COD_TIPO_CONTACTO INT IDENTITY (1,1) NOT NULL,
TIPO_CONTACTO VARCHAR(20) NULL,
CONSTRAINT PK_TIPOS_CONTACTOS PRIMARY KEY (COD_TIPO_CONTACTO)
)

CREATE TABLE TIPOS_SUMINISTROS (
COD_TIPO_SUMINISTRO INT IDENTITY (1,1) NOT NULL,
TIPO VARCHAR (20) NOT NULL,
CONSTRAINT PK_TIPO_SUMINISTROS PRIMARY KEY (COD_TIPO_SUMINISTRO)
)

CREATE TABLE DESCUENTOS (
COD_DESCUENTO INT IDENTITY(1,1) NOT NULL,
COD_TIPO_SUMINISTRO INT NOT NULL,
DESCUENTO INT NULL,
FECHA_DESDE SMALLDATETIME,
FECHA_HASTA SMALLDATETIME,
COD_LOCALIDAD INT NOT NULL,
COD_PLAN INT NOT NULL,
CONSTRAINT PK_DESCUENTOS PRIMARY KEY (COD_DESCUENTO),
CONSTRAINT FK_DESCUENTOS_TIPOS_SUMINISTOS FOREIGN KEY (COD_TIPO_SUMINISTRO) REFERENCES TIPOS_SUMINISTROS (COD_TIPO_SUMINISTRO),
CONSTRAINT FK_DESCUENTOS_LOCALIDADES FOREIGN KEY (COD_LOCALIDAD) REFERENCES LOCALIDADES (COD_LOCALIDAD),
CONSTRAINT FK_DESCUENTOS_PLANES FOREIGN KEY (COD_PLAN) REFERENCES PLANES (COD_PLAN),
)

CREATE TABLE SUMINISTROS (
COD_SUMINISTRO INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR (20) NOT NULL,
DESCRIPCION VARCHAR (20) NULL,
VENTA_LIBRE BIT NOT NULL,
PRECIO DECIMAL (10,2) NOT NULL,
COD_TIPO_SUMINISTRO INT NOT NULL,
STOCK_MINIMO INT NOT NULL,
STOCK INT NOT NULL,
CONSTRAINT PK_SUMINISTROS PRIMARY KEY (COD_SUMINISTRO),
CONSTRAINT FK_SUMINISTROS_TIPOS_SUMINISTROS FOREIGN KEY (COD_TIPO_SUMINISTRO) REFERENCES TIPOS_SUMINISTROS (COD_TIPO_SUMINISTRO),
)

CREATE TABLE EMPLEADOS (
COD_EMPLEADO INT IDENTITY (1,1) NOT NULL,
NOMBRE VARCHAR(20) NOT NULL,
APELLIDO VARCHAR(20) NOT NULL,
COD_TIPO_DOC INT NOT NULL,
NRO_DOC INT NOT NULL,
COD_BARRIO INT NULL,
NRO_CALLE INT NULL,
CALLE VARCHAR(20) NULL,
FECHA_NAC SMALLDATETIME,
COD_SUCURSAL INT NOT NULL,
COD_EMPRESA_LOG INT NOT NULL,
CONSTRAINT PK_EMPLEADOS PRIMARY KEY (COD_EMPLEADO),
CONSTRAINT FK_EMPLEADOS_TIPOS_DOCUMENTOS FOREIGN KEY (COD_TIPO_DOC) REFERENCES TIPOS_DOCUMENTOS (COD_TIPO_DOC),
CONSTRAINT FK_EMPLEADOS_BARRIOS FOREIGN KEY (COD_BARRIO) REFERENCES BARRIOS (COD_BARRIO),
CONSTRAINT FK_EMPLEADOS_SUCURSALES FOREIGN KEY (COD_SUCURSAL) REFERENCES SUCURSALES (COD_SUCURSAL),
CONSTRAINT FK_EMPLEADOS_EMPRESAS_LOGISTICA FOREIGN KEY (COD_EMPRESA_LOG) REFERENCES EMPRESAS_LOGISTICA (COD_EMPRESA_LOG)
)

CREATE TABLE CONTACTOS (
COD_CONTACTO INT IDENTITY (1,1) NOT NULL,
CONTACTO VARCHAR(20) NULL,
COD_CLIENTE INT NOT NULL,
COD_EMPRESA_LOG INT NOT NULL,
COD_TIPO_CONTACTO INT NOT NULL,
COD_EMPLEADO INT NOT NULL,
CONSTRAINT PK_CONTACTOS PRIMARY KEY (COD_CONTACTO),
CONSTRAINT FK_CONTACTOS_CLIENTES FOREIGN KEY (COD_CLIENTE) REFERENCES CLIENTES (COD_CLIENTE),
CONSTRAINT FK_CONTACTOS_EMPRESAS_LOGISTICA FOREIGN KEY (COD_EMPRESA_LOG) REFERENCES EMPRESAS_LOGISTICA (COD_EMPRESA_LOG),
CONSTRAINT FK_CONTACTOS_TIPOS_CONTACTOS FOREIGN KEY (COD_TIPO_CONTACTO) REFERENCES TIPOS_CONTACTOS(COD_TIPO_CONTACTO),
CONSTRAINT FK_CONTACTOS_EMPLEADOS FOREIGN KEY (COD_EMPLEADO) REFERENCES EMPLEADOS (COD_EMPLEADO),
)

CREATE TABLE SUCURSALES (
COD_SUCURSAL INT IDENTITY (1,1) NOT NULL,
NRO_CALLE INT NULL,
CALLE VARCHAR (20) NULL,
COD_CONTACTO INT NOT NULL,
COD_BARRIO INT NOT NULL,
CONSTRAINT PK_SUCURSALES PRIMARY KEY (COD_SUCURSAL),
CONSTRAINT FK_SUCURSALES_CONTACTOS FOREIGN KEY (COD_CONTACTO) REFERENCES CONTACTOS (COD_CONTACTO),
CONSTRAINT FK_SUCURSALES_BARRIOS FOREIGN KEY (COD_BARRIO) REFERENCES BARRIOS (COD_BARRIO),
)



CREATE TABLE ENTREGAS_SUMINISTROS (
COD_ENTREGA_SUM INT IDENTITY (1,1)  NOT NULL,
FECHA SMALLDATETIME,
COD_EMPLEADO INT  NOT NULL,
COD_EMPLEADO_LOG INT  NOT NULL,
COD_SUCURSAL INT  NOT NULL,
CONSTRAINT PK_ENTREGAS_SUMINISTROS PRIMARY KEY (COD_ENTREGA_SUM),
CONSTRAINT FK_ENTREGAS_SUMINISTROS_EMPLEADOS FOREIGN KEY (COD_EMPLEADO) REFERENCES EMPLEADOS (COD_EMPLEADO),
CONSTRAINT FK_ENTREGAS_SUMINISTROS_SUCURSALES FOREIGN KEY (COD_SUCURSAL) REFERENCES SUCURSALES (COD_SUCURSAL),
)

CREATE TABLE DETALLES_ENTREGAS (
COD_ENTREGA_SUM INT NOT NULL,
COD_SUMINISTRO INT NOT NULL,
CANTIDAD INT,
CONSTRAINT FK_DETALLES_ENTREGAS_ENTREGAS_SUMINISTROS FOREIGN KEY (COD_ENTREGA_SUM) REFERENCES ENTREGAS_SUMINISTROS (COD_ENTREGA_SUM),
CONSTRAINT FK_DETALLES_ENTREGAS_SUMINISTROS FOREIGN KEY (COD_SUMINISTRO) REFERENCES SUMINISTROS (COD_SUMIINSTRO),
)



CREATE TABLE RECETAS (
COD_RECETA INT IDENTITY (1,1) NOT NULL,
DIAGNOSTICO VARCHAR (50)  NOT NULL,
FECHA SMALLDATETIME,
COD_MEDICO INT  NOT NULL,
COD_CLIENTE INT  NOT NULL,
COD_FACTURA INT  NOT NULL,
CONSTRAINT PK_RECETAS PRIMARY KEY (COD_RECETA),
CONSTRAINT FK_RECETAS_MEDICOS FOREIGN KEY (COD_MEDICO) REFERENCES MEDICOS (COD_MEDICO),
CONSTRAINT FK_RECETAS_CLIENTES FOREIGN KEY (COD_CLIENTE) REFERENCES CLIENTES (COD_CLIENTE),
CONSTRAINT FK_RECETAS_FACTURAS FOREIGN KEY (COD_FACTURA) REFERENCES FACTURAS (COD_FACTURA),
)

CREATE TABLE FACTURAS (
COD_FACTURA INT IDENTITY (1,1)  NOT NULL,
COD_CLIENTE INT  NOT NULL,
FECHA SMALLDATETIME,
COD_EMPLEADO INT  NOT NULL,
CONSTRAINT PK_FACTURAS PRIMARY KEY (COD_FACTURA),
CONSTRAINT FK_FACTURAS_CLIENTES FOREIGN KEY (COD_CLIENTE) REFERENCES CLIENTES (COD_CLIENTE),
CONSTRAINT FK_FACTURAS_EMPLEADOS FOREIGN KEY (COD_EMPLEADO) REFERENCES EMPLEADOS (COD_EMPLEADO),
)

CREATE TABLE DETALLES_FACTURAS (
COD_DETALLE_FACTURA INT IDENTITY (1,1)  NOT NULL,
PRECIO_UNITARIO DECIMAL (10,2)  NOT NULL,
CANTIDAD INT  NOT NULL,
DESCUENTO DECIMAL  NOT NULL,
REEMBOLSADO INT  NOT NULL,
COD_FACTURA INT  NOT NULL,
COD_SUMINISTRO INT  NOT NULL,
CONSTRAINT PK_DETALLES_FACTURAS PRIMARY KEY (COD_DETALLE_FACTURA),
CONSTRAINT FK_DETALLES_FACTURAS_FACTURAS FOREIGN KEY (COD_FACTURA) REFERENCES FACTURAS (COD_FACTURA),
CONSTRAINT FK_DETALLES_FACTURAS_SUMINISTROS FOREIGN KEY (COD_SUMINISTRO) REFERENCES SUMINISTROS (COD_SUMINISTRO),
)


CREATE TABLE DETALLES_RECETA (
COD_DETALLE_RECETA INT IDENTITY (1,1)  NOT NULL,
CANTIDAD INT  NOT NULL,
COD_APROBACION INT  NOT NULL,
COD_RECETA INT  NOT NULL,
COD_SUMINISTRO INT  NOT NULL,
CONSTRAINT PK_DETALLES_RECETA PRIMARY KEY (COD_DETALLE_RECETA),
CONSTRAINT FK_DETALLES_RECETA_RECETAS FOREIGN KEY (COD_RECETA) REFERENCES RECETAS (COD_RECETA),
CONSTRAINT FK_DETALLES_RECETA_SUMINISTROS FOREIGN KEY (COD_SUMINISTRO) REFERENCES SUMINISTROS (COD_SUMINISTROS),
)

CREATE TABLE SUCURSALES_SUMINISTROS (
COD_SUCURSAL INT  NOT NULL,
COD_SUMINISTRO INT  NOT NULL,
STOCK INT  NOT NULL,
STOCK_MINIMO INT  NOT NULL,
CONSTRAINT FK_SUCURSALES_SUMINISTROS_SUCURSALES FOREIGN KEY (COD_SUCURSAL) REFERENCES SUCURSALES (COD_SUCURSAL),
CONSTRAINT FK_SUCURSALES_SUMINISTROS_SUMINISTROS FOREIGN KEY (COD_SUMINISTRO) REFERENCES SUMINISTROS (COD_SUMINISTRO),
)